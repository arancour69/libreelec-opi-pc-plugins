define(["connectionManager","confirm","appRouter","globalize"],function(connectionManager,confirm,appRouter,globalize){"use strict";function alertText(options){return new Promise(function(resolve,reject){require(["alert"],function(alert){alert(options).then(resolve,resolve)})})}function deleteItem(options){var item=options.item,itemId=item.Id,parentId=item.SeasonId||item.SeriesId||item.ParentId,serverId=item.ServerId,msg=globalize.translate("ConfirmDeleteItem"),title=globalize.translate("HeaderDeleteItem"),apiClient=connectionManager.getApiClient(item.ServerId);return apiClient.getDeleteInfo(itemId).then(function(deleteInfo){return deleteInfo.Paths.length&&(msg+="\n\n"+globalize.translate("FollowingFilesWillBeDeleted")+"\n"+deleteInfo.Paths.join("\n")),msg+="\n\n"+globalize.translate("AreYouSureToContinue"),confirm({title:title,text:msg,confirmText:globalize.translate("Delete"),primary:"cancel"}).then(function(){return apiClient.deleteItem(itemId).then(function(){"back"===options.navigate?appRouter.back():options.navigate&&(parentId?appRouter.showItem(parentId,serverId):appRouter.goHome())},function(err){var result=function(){return Promise.reject(err)};return alertText(globalize.translate("ErrorDeletingItem")).then(result,result)})})})}return{deleteItem:deleteItem}});