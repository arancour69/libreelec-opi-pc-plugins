define(["appRouter","cardBuilder","loading","connectionManager","apphost","layoutManager","focusManager","scrollHelper","skinManager","globalize","dom","emby-itemscontainer","emby-scroller"],function(appRouter,cardBuilder,loading,connectionManager,appHost,layoutManager,focusManager,scrollHelper,skinManager,globalize,dom){"use strict";function enableScrollX(){return!0}function LiveTvSuggestionsTab(view,params){this.view=view,this.params=params,this.apiClient=connectionManager.getApiClient(params.serverId),initMoreButtons(view,params),view.addEventListener("click",onViewClick),this.onNowItemsContainer=view.querySelector(".activePrograms .itemsContainer"),this.onNowItemsContainer.fetchData=fetchOnNow.bind(this),this.onNowItemsContainer.getItemsHtml=getOnNowHtml.bind(this),this.onNowItemsContainer.parentContainer=dom.parentWithClass(this.onNowItemsContainer,"verticalSection"),this.episodeItemsContainer=view.querySelector(".upcomingEpisodes .itemsContainer"),this.episodeItemsContainer.fetchData=fetchEpisodes.bind(this),this.episodeItemsContainer.getItemsHtml=getEpisodesHtml.bind(this),this.episodeItemsContainer.parentContainer=dom.parentWithClass(this.episodeItemsContainer,"verticalSection"),this.movieItemsContainer=view.querySelector(".upcomingTvMovies .itemsContainer"),this.movieItemsContainer.fetchData=fetchMovies.bind(this),this.movieItemsContainer.getItemsHtml=getMoviesHtml.bind(this),this.movieItemsContainer.parentContainer=dom.parentWithClass(this.movieItemsContainer,"verticalSection"),this.sportsItemsContainer=view.querySelector(".upcomingSports .itemsContainer"),this.sportsItemsContainer.fetchData=fetchSports.bind(this),this.sportsItemsContainer.getItemsHtml=getSportsHtml.bind(this),this.sportsItemsContainer.parentContainer=dom.parentWithClass(this.sportsItemsContainer,"verticalSection"),this.kidsItemsContainer=view.querySelector(".upcomingKids .itemsContainer"),this.kidsItemsContainer.fetchData=fetchKids.bind(this),this.kidsItemsContainer.getItemsHtml=getKidsHtml.bind(this),this.kidsItemsContainer.parentContainer=dom.parentWithClass(this.kidsItemsContainer,"verticalSection"),this.newsItemsContainer=view.querySelector(".upcomingNews .itemsContainer"),this.newsItemsContainer.fetchData=fetchNews.bind(this),this.newsItemsContainer.getItemsHtml=getNewsHtml.bind(this),this.newsItemsContainer.parentContainer=dom.parentWithClass(this.newsItemsContainer,"verticalSection")}function fetchOnNow(){var apiClient=this.apiClient,limit=enableScrollX()?24:12;return apiClient.getLiveTvRecommendedPrograms({UserId:apiClient.getCurrentUserId(),IsAiring:!0,Limit:limit,ImageTypeLimit:1,EnableImageTypes:"Primary,Thumb,Backdrop",EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio"})}function getOnNowHtml(items){return getItemsHtml(items,"play")}function fetchEpisodes(){var apiClient=this.apiClient,limit=enableScrollX()?24:12;return apiClient.getLiveTvRecommendedPrograms({UserId:apiClient.getCurrentUserId(),HasAired:!1,Limit:limit,IsSports:!1,IsKids:!1,IsNews:!1,IsSeries:!0,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb"})}function getEpisodesHtml(items){return getItemsHtml(items)}function fetchMovies(){var apiClient=this.apiClient,limit=enableScrollX()?24:12;return apiClient.getLiveTvRecommendedPrograms({userId:apiClient.getCurrentUserId(),HasAired:!1,Limit:limit,IsMovie:!0,IsKids:!1,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb"})}function getMoviesHtml(items){return getItemsHtml(items,null,{shape:getPortraitShape(),preferThumb:null,lines:2})}function fetchSports(){var apiClient=this.apiClient,limit=enableScrollX()?24:12;return apiClient.getLiveTvRecommendedPrograms({userId:apiClient.getCurrentUserId(),HasAired:!1,Limit:limit,IsSports:!0,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb"})}function getSportsHtml(items){return getItemsHtml(items,null,{})}function fetchKids(){var apiClient=this.apiClient,limit=enableScrollX()?24:12;return apiClient.getLiveTvRecommendedPrograms({userId:apiClient.getCurrentUserId(),HasAired:!1,Limit:limit,IsKids:!0,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb"})}function getKidsHtml(items){return getItemsHtml(items,null,{})}function fetchNews(){var apiClient=this.apiClient,limit=enableScrollX()?24:12;return apiClient.getLiveTvRecommendedPrograms({userId:apiClient.getCurrentUserId(),HasAired:!1,Limit:limit,IsNews:!0,EnableTotalRecordCount:!1,Fields:"PrimaryImageAspectRatio",EnableImageTypes:"Primary,Thumb"})}function getNewsHtml(items){return getItemsHtml(items,null,{})}function onViewClick(e){var textButtonCard=dom.parentWithClass(e.target,"textButtonCard");if(textButtonCard){dom.parentWithClass(textButtonCard,"verticalSection").querySelector(".btnMore").click()}}function initMoreButtons(view,params){[].forEach.call(view.querySelectorAll(".sectionTitleTextButton-programs"),function(link){var href=link.getAttribute("data-href");href&&(link.href=skinManager.mapRoute(href+"&serverId="+params.serverId))})}function getPortraitShape(){return enableScrollX()?"overflowPortrait":"portrait"}function getItemsHtml(items,overlayButton,cardOptions){return cardOptions=cardOptions||{},cardBuilder.getCardsHtml(Object.assign({items:items,preferThumb:"auto",inheritThumb:!1,shape:enableScrollX()?"autooverflow":"auto",showParentTitle:!0,showTitle:!0,centerText:!0,overlayText:!1,lazy:!0,overlayMoreButton:"more"===overlayButton,overlayPlayButton:"play"===overlayButton,allowBottomPadding:!enableScrollX(),showAirTime:!0,showAirDateTime:!0,lines:3,multiSelect:!1},cardOptions))}return LiveTvSuggestionsTab.prototype.onResume=function(options){var promises=[];promises.push(this.onNowItemsContainer.resume(options)),promises.push(this.episodeItemsContainer.resume(options)),promises.push(this.movieItemsContainer.resume(options)),promises.push(this.sportsItemsContainer.resume(options)),promises.push(this.kidsItemsContainer.resume(options)),promises.push(this.newsItemsContainer.resume(options));var view=this.view,scroller=view.querySelector(".scrollFrameY");Promise.all(promises).then(function(){options.autoFocus&&focusManager.autoFocus(scroller)})},LiveTvSuggestionsTab.prototype.onPause=function(){this.onNowItemsContainer.pause(),this.episodeItemsContainer.pause(),this.movieItemsContainer.pause(),this.sportsItemsContainer.pause(),this.kidsItemsContainer.pause(),this.newsItemsContainer.pause()},LiveTvSuggestionsTab.prototype.destroy=function(){this.view=null,this.params=null,this.apiClient=null,this.onNowItemsContainer=null,this.episodeItemsContainer=null,this.movieItemsContainer=null,this.sportsItemsContainer=null,this.kidsItemsContainer=null,this.newsItemsContainer=null},LiveTvSuggestionsTab});